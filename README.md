# Курс Highload. Проект веб-сервиса

### Выбор темы

Сервис-мессенджер (Telegram)

Функционал MVP: отправка и получение текстовых сообщений, которые сохраняются на сервере в открытом виде. 

### Расчет нагрузки

* Аудитория: 7 миллионов человек ([аудитория Facebook Messenger в 2020 году]([Аудитория Telegram в России за месяц выросла на 1,2 млн пользователей](https://www.dp.ru/a/2020/10/17/Auditorija_Telegram_v_Ross)))

* География пользователей: РФ

* Среднее кол-во сообщений в день на одного пользователя: [150]([50+ Telegram Statistics That Will Blow Your Mind (2021)](https://bloggingx.com/telegram-statistics/#:~:text=Telegram%20user%20and%20usage%20statistics&text=It%20is%20estimated%20that%20around,sent%20daily%20per%20Telegram%20user.))

* Средняя длительность сессии: [12 минут](https://www.likeni.ru/events/whatsapp-samyy-populyarnyy-messendzher-u-abonentov-bilayna/)

* Максимальная длина одного сообщения: 4096 символов ([макс. размер сообщения в Telegram](https://www.vamtlgrm.com/limity-sushhestvuyushhie-v-telegram/#:~:text=%D0%94%D0%BB%D0%B8%D0%BD%D0%B0%20%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE%20%D1%81%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%B2%20%D0%BB%D0%B8%D1%87%D0%BD%D1%8B%D1%85,%D0%B8%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0%D1%85%20%E2%80%94%20%D0%B4%D0%BE%201024%20%D1%81%D0%B8%D0%BC%D0%B2%D0%BE%D0%BB%D0%BE%D0%B2.))

* Размер одного сообщения: 9 Кб (сообщ. макс. длины на кириллице, закодированное в UTF-8 + 1 кб метаданных)

* Дополнительные запросы: получение списка сообщений в диалоге (отправляются последние 20 сообщений, при прокрутке диалога - отправка запроса на предыдущие 100 сообщений)

* Общее кол-во запросов в сутки: 
  
  * 150 отправок сообщений
  
  * 300 просмотров диалогов (пользователь открывает диалог при получении и при отправке сообщений) 
  
  * 100 запросов на получение предыдущих сообщений (пользователь открывает диалог для чтения)
    
    

* Avg Requests Per Day
  
  * : 7 * 10^6 * (150+300+50) = 3.5 * 10^9 rpd

* Avg Requests Per Second:
  
  *  3.5 * 10^9 / 24 / 60 /60 = 40'500 rps

* Среднее кол-во одновременных сессий:
  
  *  7 * 10^6 / 24 / 60 * 12  = 58'333 

* Входящий трафик за сутки:  
  
  * 7 * 10^6 * 150 *  9216 = 8.8 ТБ

* Исходящий трафик за сутки:
  
  * 7 * 10^6 * (150 + 300 * 20 + 100 * 100)  * 9216 = 948 ТБ
  
  

Примем, что пиковые нагрузки превышают средние в 3 раза (согласно [статистике](https://www.protarif.info/news/new?id=1449) мобильных операторов)

* Peak PRS: 121'500 

* Пиковое кол-во одновременных сессий: 175'000

* Пиковый входящий трафик (в секунду):
  
  * 8.8 ТБ * 3 / 24 /60 / 60 = 2.5 Гбит/Сек

* Пиковый исходящий трафик (в секунду):
  
  - 948ТБ * 3 / 24 /60 / 60 = 270 Гбит/Сек